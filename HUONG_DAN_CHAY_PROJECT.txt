================================================================================
  HÆ¯á»šNG DáºªN CHáº Y PROJECT VOICEAI-CALLOUTV2 (Cáº¬P NHáº¬T 100%)
  Bao gá»“m: Backend + Database + NLP + Deeppavlov Agent
================================================================================

ğŸ“‹ YÃŠU Cáº¦U Há»† THá»NG:
  - Python 3.11
  - Virtual environment Ä‘Ã£ cÃ i Ä‘áº·t (.venv)
  - File .env vá»›i SUPABASE_URL vÃ  SUPABASE_KEY
  - Port 8000 (Backend) vÃ  Port 4242 (Agent) khÃ´ng bá»‹ chiáº¿m dá»¥ng

================================================================================
ğŸš€ CÃCH CHáº Y PROJECT HOÃ€N CHá»ˆNH (3 TERMINALS)
================================================================================

âš ï¸  QUAN TRá»ŒNG: Cáº§n má»Ÿ 3 terminal riÃªng biá»‡t!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TERMINAL 1: DEEPPAVLOV AGENT (Port 4242)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  cd C:\Users\Admin\VoiceAI
  .\.venv\Scripts\Activate.ps1
  python agent/http_agent.py

  Káº¿t quáº£ mong Ä‘á»£i:
    ============================================================
      ğŸ¤– DEEPPAVLOV AGENT SERVER (HTTP)
      Running on: http://localhost:4242
    ============================================================
    INFO:     Application startup complete.

  âš ï¸  GIá»® TERMINAL NÃ€Y Má» - Äá»ªNG Táº®T!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TERMINAL 2: BACKEND API (Port 8000)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  cd C:\Users\Admin\VoiceAI
  .\.venv\Scripts\Activate.ps1
  python -X utf8 -m uvicorn app.main:app --reload

  Káº¿t quáº£ mong Ä‘á»£i:
    INFO:     Uvicorn running on http://127.0.0.1:8000
    Ket noi Supabase thanh cong!
    INFO:app.services.model_manager:ÄÃ£ táº£i mÃ´ hÃ¬nh thÃ nh cÃ´ng
    Dialog Manager (HTTP Client) da san sang goi Agent...
    INFO:     Application startup complete.

  âš ï¸  GIá»® TERMINAL NÃ€Y Má» - Äá»ªNG Táº®T!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TERMINAL 3: TEST & DEVELOPMENT                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  cd C:\Users\Admin\VoiceAI
  .\.venv\Scripts\Activate.ps1

  # Test há»‡ thá»‘ng cÆ¡ báº£n (8 tests)
  python test_full_system.py

  # Test vá»›i Agent (4 conversations)
  python test_with_agent.py

  Káº¿t quáº£ mong Ä‘á»£i:
    ğŸ‰ THÃ€NH CÃ”NG! Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng hoÃ n chá»‰nh 100%
    âœ… Backend API: OK
    âœ… Database: OK
    âœ… NLP PhoBERT: OK
    âœ… Deeppavlov Agent: OK


================================================================================
ğŸ“Œ Lá»†NH NHANH (COPY & PASTE)
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal 1: Agent Server                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
cd C:\Users\Admin\VoiceAI
.\.venv\Scripts\Activate.ps1
python agent/http_agent.py

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal 2: Backend API                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
cd C:\Users\Admin\VoiceAI
.\.venv\Scripts\Activate.ps1
python -X utf8 -m uvicorn app.main:app --reload

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal 3: Test                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
cd C:\Users\Admin\VoiceAI
.\.venv\Scripts\Activate.ps1
python test_with_agent.py

================================================================================
ğŸ” KIá»‚M TRA Há»† THá»NG HOáº T Äá»˜NG
================================================================================

Test Agent:
  curl http://localhost:4242/health
  
  Káº¿t quáº£: {"status":"ok","message":"Agent server is running"}

Test Backend API:
  curl http://127.0.0.1:8000
  
  Káº¿t quáº£: {"status":"ok","message":"Welcome to VoiceAI API"}

Má»Ÿ Swagger UI (API Documentation):
  http://127.0.0.1:8000/docs

Test Ä‘áº§y Ä‘á»§ há»‡ thá»‘ng:
  python test_full_system.py     # 8 tests cÆ¡ báº£n
  python test_with_agent.py      # 4 tests vá»›i Agent

================================================================================
ğŸ”§ Xá»¬ LÃ Lá»–I THÆ¯á»œNG Gáº¶P
================================================================================

Lá»–I 1: "No module named 'xyz'"
  Giáº£i phÃ¡p: CÃ i Ä‘áº·t láº¡i dependencies
    pip install -r requirements.txt

Lá»–I 2: "Address already in use" (Port 8000 hoáº·c 4242 bá»‹ chiáº¿m)
  Giáº£i phÃ¡p A: TÃ¬m vÃ  táº¯t tiáº¿n trÃ¬nh Ä‘ang dÃ¹ng port
    # TÃ¬m process Ä‘ang dÃ¹ng port 8000
    netstat -ano | findstr :8000
    # Táº¯t process (thay <PID> báº±ng sá»‘ process ID)
    taskkill /PID <PID> /F
    
  Giáº£i phÃ¡p B: Táº¯t táº¥t cáº£ Python processes
    Get-Process | Where-Object {$_.ProcessName -eq "python"} | Stop-Process -Force

Lá»–I 3: "Supabase connection failed"
  Giáº£i phÃ¡p: Kiá»ƒm tra file .env cÃ³ Ä‘Ãºng SUPABASE_URL vÃ  SUPABASE_KEY
    # File .env pháº£i cÃ³:
    SUPABASE_URL=https://xxx.supabase.co
    SUPABASE_KEY=eyJxxx...

Lá»—I 4: "Row-level security policy violated"
  Giáº£i phÃ¡p: Cháº¡y script SQL Ä‘á»ƒ táº¯t RLS
    VÃ o Supabase Dashboard > SQL Editor
    Cháº¡y file: sql/disable_rls_for_app_tables.sql

Lá»–I 5: "Agent server CHÆ¯A cháº¡y" hoáº·c "Khong the ket noi den Agent"
  Giáº£i phÃ¡p: 
    - Kiá»ƒm tra Terminal 1 cÃ³ Ä‘ang cháº¡y agent/http_agent.py khÃ´ng
    - Test báº±ng: curl http://localhost:4242/health
    - Náº¿u port 4242 bá»‹ chiáº¿m, tÃ¬m vÃ  táº¯t process Ä‘Ã³

Lá»–I 6: Test lá»—i "Field required" hoáº·c validation error
  Giáº£i phÃ¡p: Kiá»ƒm tra API schema trong Swagger docs
    http://127.0.0.1:8000/docs
    Xem Ä‘Ãºng field names vÃ  types

================================================================================
ğŸ“š CÃC FILE QUAN TRá»ŒNG
================================================================================

Cáº¤U HÃŒNH:
  .env                          - Cáº¥u hÃ¬nh mÃ´i trÆ°á»ng (SUPABASE credentials)
  requirements.txt              - Danh sÃ¡ch dependencies Python

BACKEND:
  app/main.py                   - Entry point cá»§a FastAPI server
  app/routers/                  - API endpoints (auth, workflows, calls)
  app/services/                 - Business logic (NLP, Agent, Asterisk)

AGENT:
  agent/http_agent.py           - HTTP-based Deeppavlov Agent (KHUYáº¾N NGHá»Š)
  agent/run_agent.py            - ZMQ-based Agent (nÃ¢ng cao)

DATABASE:
  sql/schema_complete.sql       - Schema database Ä‘áº§y Ä‘á»§ (9 tables)
  sql/disable_rls_for_app_tables.sql - Script táº¯t RLS

TESTING:
  test_full_system.py           - Test toÃ n bá»™ API (8 tests)
  test_with_agent.py            - Test vá»›i Agent (4 conversations)
  quick_test.py                 - Script test nhanh 3 endpoints

MODELS:
  models/phobert-intent-classifier/ - PhoBERT model
  train_intent_model.py         - Script train láº¡i model

DOCUMENTATION:
  README.md                     - Tá»•ng quan dá»± Ã¡n
  HUONG_DAN_CHAY_PROJECT.txt    - HÆ°á»›ng dáº«n cháº¡y (file nÃ y)
  HOAN_THANH_100_PHAN_TRAM.txt  - HÆ°á»›ng dáº«n hoÃ n thÃ nh 100%

================================================================================
ğŸŒ API ENDPOINTS
================================================================================

AUTHENTICATION:
  POST   /api/auth/register           - ÄÄƒng kÃ½ tÃ i khoáº£n
  POST   /api/auth/token              - ÄÄƒng nháº­p (láº¥y JWT token)

WORKFLOWS:
  GET    /api/workflows/              - Láº¥y danh sÃ¡ch workflows
  POST   /api/workflows/              - Táº¡o workflow má»›i
  PUT    /api/workflows/{id}          - Táº¡o version cho workflow
  GET    /api/workflows/{id}/versions - Xem lá»‹ch sá»­ versions

CALLS:
  POST   /api/calls/start_call        - Báº¯t Ä‘áº§u cuá»™c gá»i
  POST   /api/calls/webhook           - Xá»­ lÃ½ há»™i thoáº¡i
    Body: {"call_id": "uuid", "speech_to_text": "text"}

DOCS:
  GET    /docs                        - Swagger UI
  GET    /redoc                       - ReDoc
  GET    /api/workflows/{id}/versions - Xem lá»‹ch sá»­ versions
  
  POST   /api/calls/start_call        - Báº¯t Ä‘áº§u cuá»™c gá»i
  POST   /api/calls/webhook           - Xá»­ lÃ½ há»™i thoáº¡i (webhook)

  Swagger Docs: http://127.0.0.1:8000/docs

================================================================================
âœ… Káº¾T QUáº¢ Máº¤U KHI CHáº Y THÃ€NH CÃ”NG
================================================================================

Server khá»Ÿi Ä‘á»™ng:
  INFO:     Uvicorn running on http://127.0.0.1:8000
  INFO:     Application startup complete.
  Ket noi Supabase thanh cong!
  INFO:app.services.model_manager:ÄÃ£ táº£i mÃ´ hÃ¬nh thÃ nh cÃ´ng

Test thÃ nh cÃ´ng:
  âœ… ÄÄƒng kÃ½
  âœ… ÄÄƒng nháº­p
  âœ… Táº¡o workflow
  âœ… Láº¥y workflows
  âœ… Táº¡o version
  âœ… Xem versions
  âœ… Báº¯t Ä‘áº§u cuá»™c gá»i
  âœ… Test há»™i thoáº¡i
  
  Tá»•ng káº¿t: 8/8 tests passed (100%)

================================================================================
ğŸ“ Há»– TRá»¢
================================================================================

  - Kiá»ƒm tra logs trong terminal Ä‘á»ƒ debug
  - Xem file README.md Ä‘á»ƒ hiá»ƒu kiáº¿n trÃºc há»‡ thá»‘ng
  - Xem file .github/copilot-instructions.md Ä‘á»ƒ hiá»ƒu cáº¥u trÃºc code

================================================================================
